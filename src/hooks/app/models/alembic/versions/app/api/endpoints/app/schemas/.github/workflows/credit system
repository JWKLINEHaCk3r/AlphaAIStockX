#!/bin/bash

set -e

# ==== CONFIGURATION ====
REPO_URL="git@github.com:JWKLINEHaCk3r/AlphaAIStockX.git"
BRANCH="main"
PROJECT_DIR="AlphaAIStockX"

# ==== SETUP ====
echo "ðŸš€ Cloning project repository..."
rm -rf $PROJECT_DIR
git clone $REPO_URL $PROJECT_DIR
cd $PROJECT_DIR
git checkout $BRANCH

# ==== BUILD DOCKER ====
echo "ðŸ”§ Building Docker containers..."
docker-compose down
docker-compose build
docker-compose up -d

# ==== RUN ALEMBIC MIGRATIONS ====
echo "ðŸ”„ Running Alembic migrations..."
docker-compose exec web alembic upgrade head

# ==== COMMIT AND PUSH ====
echo "ðŸ“¤ Committing changes..."
git add .
git commit -m "ðŸŽ¯ Full deployment: Credit AI, Docker, CI/CD, scoring"
git push origin $BRANCH

echo "âœ… Deployment complete and pushed to GitHub."
